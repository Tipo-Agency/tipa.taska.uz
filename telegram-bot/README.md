# Telegram Bot –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏

Telegram –±–æ—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ `tipa.taska.uz`.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firebase

**–î–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –ù–£–ñ–ï–ù Firebase Service Account (JSON —Ñ–∞–π–ª —Å –∫–ª—é—á–∞–º–∏).**

üìñ **–ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. [QUICK_START.md](./QUICK_START.md)

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. [SERVER_SETUP.md](./SERVER_SETUP.md)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ Firebase Service Account:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç `tipa-task-manager`
   - Project Settings ‚Üí Service accounts ‚Üí Generate new private key
   - –°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   scp ~/Downloads/tipa-task-manager-firebase-adminsdk-xxxxx.json user@server:/var/www/tipa.taska.uz/telegram-bot/firebase-credentials.json
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:**
   ```bash
   cd telegram-bot
   nano .env
   ```
   
   –î–æ–±–∞–≤—å—Ç–µ:
   ```env
   TELEGRAM_BOT_TOKEN=8348357222:AAHzzrWFOE7n3MiGYKgugqXbUSehTW1-D1c
   FIREBASE_PROJECT_ID=tipa-task-manager
   FIREBASE_CREDENTIALS_PATH=/var/www/tipa.taska.uz/telegram-bot/firebase-credentials.json
   DEFAULT_TIMEZONE=Asia/Tashkent
   ```

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip install -r requirements.txt
   ```

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
python bot.py
```

### –ó–∞–ø—É—Å–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π)

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –ø—Ä–∏ –ø—É—à–µ –≤ `main` –≤–µ—Ç–∫—É —á–µ—Ä–µ–∑ GitHub Actions.

–î–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
./deploy.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –°–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–µ—Ç systemd service
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

```bash
# –°—Ç–∞—Ç—É—Å
sudo systemctl status telegram-bot

# –ó–∞–ø—É—Å–∫
sudo systemctl start telegram-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo systemctl stop telegram-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart telegram-bot

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u telegram-bot -f
```

## –§—É–Ω–∫—Ü–∏–∏

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∞–º–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö –∏ –∑–∞—è–≤–∫–∞—Ö
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–¥–∞—á–∞—Ö (9:00)
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 9:00)
- –ì—Ä—É–ø–ø–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–∫–∞—Ö
- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (—Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è, –∞–≤–∞—Ç–∞—Ä–∫–∏)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `bot.py` - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
- `auth.py` - –º–æ–¥—É–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `tasks.py` - –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–∞—á–∞–º–∏
- `deals.py` - –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å–æ —Å–¥–µ–ª–∫–∞–º–∏
- `clients.py` - –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- `notifications.py` - –º–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `profile.py` - –º–æ–¥—É–ª—å –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
- `scheduler.py` - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- `firebase_client.py` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Firebase
- `keyboards.py` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–º–µ–Ω—é –∏ –∫–Ω–æ–ø–∫–∏)
- `messages.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- `utils.py` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[FIREBASE_SERVICE_ACCOUNT_SETUP.md](./FIREBASE_SERVICE_ACCOUNT_SETUP.md)** ‚≠ê - **–ü–æ–¥—Ä–æ–±–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Service Account** (–Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞!)
- **[QUICK_START.md](./QUICK_START.md)** - –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ (–µ—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç)
- **[SERVER_SETUP.md](./SERVER_SETUP.md)** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **[FIREBASE_SETUP.md](./FIREBASE_SETUP.md)** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firebase (REST API vs Admin SDK)
- **[../docs/TELEGRAM_BOT_TZ.md](../docs/TELEGRAM_BOT_TZ.md)** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
